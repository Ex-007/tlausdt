<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <script type="module">
        import { createClient } from 'https://esm.sh/@supabase/supabase-js';

        const supabaseUrl = 'https://opjxgfjfjvcexhizvyar.supabase.co';
        const supabaseKey =
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9wanhnZmpmanZjZXhoaXp2eWFyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzI3ODMzMTUsImV4cCI6MjA0ODM1OTMxNX0.Vx5dbIopGNk2EU825CEPSVU5fIrlBp0d2yJi1fL_A80';

        const supabase = createClient(supabaseUrl, supabaseKey);

        const email = localStorage.getItem('email')

        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('token');
        const type = urlParams.get('type');

        // http://localhost:5501/#access_token=eyJhbGciOiJIUzI1NiIsImtpZCI6IkU4NnRLZGo5Z1pXb0lScXMiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL29wanhnZmpmanZjZXhoaXp2eWFyLnN1cGFiYXNlLmNvL2F1dGgvdjEiLCJzdWIiOiI0M2JhYzJhMC04ZmFjLTRhZWItYWZiNi04YTU3NDYyMjE4ZWQiLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzQzMDY2ODg2LCJpYXQiOjE3NDMwNjMyODYsImVtYWlsIjoiYWdiZWJpYmlkZW1pMDJAZ21haWwuY29tIiwicGhvbmUiOiIiLCJhcHBfbWV0YWRhdGEiOnsicHJvdmlkZXIiOiJlbWFpbCIsInByb3ZpZGVycyI6WyJlbWFpbCJdfSwidXNlcl9tZXRhZGF0YSI6eyJlbWFpbCI6ImFnYmViaWJpZGVtaTAyQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZnVsbG5hbWUiOiJBZ2JlYmkgQmlkZW1pIiwicGhvbmVfdmVyaWZpZWQiOmZhbHNlLCJzdWIiOiI0M2JhYzJhMC04ZmFjLTRhZWItYWZiNi04YTU3NDYyMjE4ZWQifSwicm9sZSI6ImF1dGhlbnRpY2F0ZWQiLCJhYWwiOiJhYWwxIiwiYW1yIjpbeyJtZXRob2QiOiJvdHAiLCJ0aW1lc3RhbXAiOjE3NDMwNjMyODZ9XSwic2Vzc2lvbl9pZCI6IjRlZDczNDdiLWZiYjAtNGQyZi1hYTEyLTMzN2RiMzc2ZWFmMCIsImlzX2Fub255bW91cyI6ZmFsc2V9.MwxP6JWH8-mT-5KyZ1Q4fQd6F2u3S0LWt2xAYd6xpAw&expires_at=1743066886&expires_in=3600&refresh_token=NNv1vJA3T9XnvoTNF_Fn5w&token_type=bearer&type=magiclink

    const sendsigninnOtp = async () => {
        
        if(!token || !type !== 'email') {
            alert('Invalid URL')
            return
        }
        const { data, error } = await supabase.auth.verifyOtp({ 
            token: token,
            type: 'email'
         });
        if (error) {
            alert(error.message)
            console.log(error)
        } else {
            alert('Welcome to the dashboard')
            window.location.href = 'userdash.html'
        }   
    }
    sendsigninnOtp()
    </script>
</body>
</html>